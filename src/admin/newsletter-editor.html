<div class="container-fluid">
  <h2 ng-show="edit">Rediger nyhedsbrev <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span></h2>
  <h2 ng-hide="edit">Nyhedsbrev</h2>
  <div class="row">
    <div class="col-xs-4">
      <div class="form-group">
        <label for="name_control">Name</label>
        <input
          id="name_control"
          class="form-control"
          type="text"
          ng-model="newsletter.name"
          xng-disabled="!edit"
          placeholder="Insert name"/>
      </div>
    </div>
    <div class="col-xs-2">
      <div class="form-group">
        <label for="identity_control">Afsender</label>
        <select
          id="identity_control"
          class="form-control"
          ng-model="newsletter.identity"
          ng-options="identity for identity in identities"
          ng-disabled="!edit"
          ng-required="true">
        </select>
      </div>
    </div>
    <div class="col-xs-2">
      <div class="form-group">
        <label for="list_control">Modtagerliste</label>
        <select
          id="list_control"
          class="form-control"
          ng-model="newsletter.list"
          ng-options="list for list in lists"
          ng-disabled="!edit"
          ng-required="true">
          <option value=""></option>
        </select>
      </div>
    </div>
    <div class="col-xs-2" ng-show="edit">
      <div class="form-group">
        <label for="category_control">Tilf√∏j kategori</label>
        <input id="category_control" class="form-control" type="text" ng-model="newCategory" ng-keyup="addCategory($event)" ng-disabled="!edit" placeholder="Skriv her"/>
      </div>
    </div>
    <div class="col-xs-2">
      <label for="category_control">Kategorier</label>
      <ul class="list-inline">
        <li ng-repeat="category in newsletter.categories track by $index">
          <span id="category-{{category}}" class="label label-info">{{category}} <span class="glyphicon glyphicon-remove" ng-show="edit" ng-click="removeCategory($index)"></span>&nbsp;</span>
        </li>
      </ul>
    </div>
  </div>

  <div class="row" ng-show="edit">
    <div class="col-xs-4">
      <a class="btn btn-danger" ng-href="#/{{newsletter.name}}">
        Luk <span class="glyphicon glyphicon-chevron-left"></span>
      </a>
      <button ng-hide="true" type="button" class="btn btn-success" ng-click="saveNewsletter(true)" ng-disabled="loading_previews">
        Gem og luk edit <span class="glyphicon glyphicon-floppy-saved"></span>
      </button>
      <button type="button" class="btn btn-success" ng-click="saveNewsletter()" ng-disabled="loading_previews">
        Gem <span class="glyphicon glyphicon-floppy-disk"></span>
      </button>
      <button type="button" class="btn btn-danger btn-xs" ng-click="deleteNewsletter()">
        Slet <span class="glyphicon glyphicon-remove"></span>
      </button>
    </div>
    <div class="col-xs-6">
      <button type="button" class="btn btn-info" ng-click="updatePreviewClickEvent()" ng-disabled="loading_previews">
        Opdater preview <span class="glyphicon glyphicon-refresh"></span>
      </button>
    </div>
  </div>

  <div class="row" ng-hide="edit">
    <div class="col-xs-4">
      <a class="btn btn-default" ng-href="#/">
        Til oversigt <span class="glyphicon glyphicon-chevron-left"></span>
      </a>
    </div>
    <div class="col-xs-8">
      <div class="form-inline">
        <button type="button" class="btn btn-info" ng-click="updatePreviewClickEvent()" ng-disabled="loading_previews">
          Opdater <span class="glyphicon glyphicon-refresh"></span>
        </button>
        <div class="input-group">
          <span class="input-group-addon">
            Udsend om
          </span>
          <input class="form-control" type="number" ng-model="newsletter.after" min="0" style="width: 80px;">
          <span class="input-group-addon">
            minutter <span class="glyphicon glyphicon-time"></span>
          </span>
          <span class="input-group-btn">
            <button type="button" class="btn btn-danger" ng-click="sendNewsletter()" ng-disabled="loading_previews">
              Send <span class="glyphicon glyphicon-envelope"></span>
            </button>
          </span>
        </div>
        <button ng-hide="true" type="button" class="btn btn-warning" ng-click="draftNewsletter()" ng-disabled="loading_previews">
          Opret kladde <span class="glyphicon glyphicon-inbox"></span>
        </button>
        <a ng-href="{{ controlroom_url }}" target="_blank" class="btn btn-link" ng-disabled="loading_previews">
          &Aring;bn BOND Controlroom
        </a>
      </div>
    </div>
  </div>

  <hr>

  <div class="row" ng-show="edit">
    <div class="col-xs-6">
      <div class="form-group">
        <label for="bond_url_control">BOND URL</label>
        <input
          id="bond_url_control"
          type="text"
          class="form-control"
          placeholder="Insert BOND root URL"
          ng-model="newsletter.bond_url"
          ng-disabled="!edit">
      </div>
    </div>
    <div class="col-xs-3">
      <div class="form-group">
        <label for="template_html_control">HTML Template</label>
        <select
          id="template_html_control"
          class="form-control"
          ng-model="newsletter.template_html"
          ng-options="template_html for template_html in html_templates"
          ng-disabled="!edit"
          ng-required="true">
        </select>
      </div>
    </div>
    <div class="col-xs-3">
      <div class="form-group">
        <label for="template_plain_control">Text Template</label>
        <select
          id="template_plain_control"
          class="form-control"
          ng-model="newsletter.template_plain"
          ng-options="template_plain for template_plain in plain_templates"
          ng-disabled="!edit"
          ng-required="true">
        </select>
      </div>
    </div>
  </div>

  <!-- PREVIEW -->
  <div class="row">
    <div class="col-xs-12">
      <div class="panel panel-primary">
        <div class="panel-heading">Emnefelt</div>
        <div class="panel-body">
          <p ng-show="loading_html_preview">Loading...</p>
          <input ng-hide="loading_html_preview" type="text" class="form-control" ng-model="newsletter.subject">
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-12 col-lg-12">
      <div class="panel panel-primary">
        <div class="panel-heading">HTML indhold <span style="float:right;"><a target="_blank" ng-href="{{ html_url }}?debug=true">Debug link</a></span></div>
        <div class="panel-body">
          <p ng-show="loading_html_preview">Loading...</p>
          <iframe ng-hide="loading_html_preview" class="newsletter-preview" srcdoc="{{trusted_html_email_preview}}"></iframe>
        </div>
      </div>
    </div>

<!--     <div class="col-md-12 col-lg-12">
      <div class="panel panel-primary">
        <div class="panel-heading">BOND Controlroom</div>
        <div class="panel-body">
          <iframe class="newsletter-preview" ng-src="{{controlroom_url}}">please upgrade your browser if you see the message</iframe>
        </div>
      </div>
    </div> -->

    <div class="col-md-12 col-lg-12">
      <div class="panel panel-primary">
        <div class="panel-heading">Text indhold</div>
        <div class="panel-body">
          <p ng-show="loading_plain_preview">Loading...</p>
          <textarea ng-hide="loading_plain_preview" class="newsletter-preview" style="background-color: white;" ng-model="newsletter.email_plain"></textarea>
        </div>
      </div>
    </div>
  </div>
</div>
